import{R as q,i as M,h as v,k as V,_ as S,l as W,m as F,n as Q,o as D,O as U,p as z,q as G,N as E,s as j,A}from"./index-RulhGnuC.js";import{a as T,v as K,D as B}from"./Section-BkEuq3rL.js";var _=!1,J="useSyncExternalStore",X=q[J],Y=X||function(r,e,t){var n=e();globalThis.__DEV__!==!1&&!_&&n!==e()&&(_=!0,globalThis.__DEV__!==!1&&M.error(68));var a=v.useState({inst:{value:n,getSnapshot:e}}),u=a[0].inst,c=a[1];return V?v.useLayoutEffect(function(){Object.assign(u,{value:n,getSnapshot:e}),m(u)&&c({inst:u})},[r,n,e]):Object.assign(u,{value:n,getSnapshot:e}),v.useEffect(function(){return m(u)&&c({inst:u}),r(function(){m(u)&&c({inst:u})})},[r]),n};function m(r){var e=r.value,t=r.getSnapshot;try{return e!==t()}catch{return!0}}var Z=Symbol.for("apollo.hook.wrappers");function $(r,e,t){var n=t.queryManager,a=n&&n[Z],u=a&&a[r];return u?u(e):e}var H=Object.prototype.hasOwnProperty;function C(){}var k=Symbol();function vr(r,e){return e===void 0&&(e=Object.create(null)),$("useQuery",rr,T(e&&e.client))(r,e)}function rr(r,e){var t=tr(r,e),n=t.result,a=t.obsQueryFields;return v.useMemo(function(){return S(S({},n),a)},[n,a])}function er(r,e,t,n,a){function u(s){var f;K(e,B.Query);var p={client:r,query:e,observable:n&&n.getSSRObservable(a())||U.inactiveOnCreation.withValue(!n,function(){return r.watchQuery(N(void 0,r,t,a()))}),resultData:{previousData:(f=s==null?void 0:s.resultData.current)===null||f===void 0?void 0:f.data}};return p}var c=v.useState(u),i=c[0],o=c[1];function d(s){var f,p;Object.assign(i.observable,(f={},f[k]=s,f));var h=i.resultData;o(S(S({},i),{query:s.query,resultData:Object.assign(h,{previousData:((p=h.current)===null||p===void 0?void 0:p.data)||h.previousData,current:void 0})}))}if(r!==i.client||e!==i.query){var y=u(i);return o(y),[y,d]}return[i,d]}function tr(r,e){var t=T(e.client),n=v.useContext(W()).renderPromises,a=!!n,u=t.disableNetworkFetches,c=e.ssr!==!1&&!e.skip,i=e.partialRefetch,o=ir(t,r,e,a),d=er(t,r,e,n,o),y=d[0],s=y.observable,f=y.resultData,p=d[1],h=o(s);ur(f,s,t,e,h);var w=v.useMemo(function(){return fr(s)},[s]);ar(s,n,c);var O=nr(f,s,t,e,h,u,i,a,{onCompleted:e.onCompleted||C,onError:e.onError||C});return{result:O,obsQueryFields:w,observable:s,resultData:f,client:t,onQueryExecuted:p}}function nr(r,e,t,n,a,u,c,i,o){var d=v.useRef(o);v.useEffect(function(){d.current=o});var y=(i||u)&&n.ssr===!1&&!n.skip?I:n.skip||a.fetchPolicy==="standby"?L:void 0,s=r.previousData,f=v.useMemo(function(){return y&&x(y,s,e,t)},[t,e,y,s]);return Y(v.useCallback(function(p){if(i)return function(){};var h=function(){var g=r.current,l=e.getCurrentResult();g&&g.loading===l.loading&&g.networkStatus===l.networkStatus&&Q(g.data,l.data)||P(l,r,e,t,c,p,d.current)},w=function(g){if(O.current.unsubscribe(),O.current=e.resubscribeAfterError(h,w),!H.call(g,"graphQLErrors"))throw g;var l=r.current;(!l||l&&l.loading||!Q(g,l.error))&&P({data:l&&l.data,error:g,loading:!1,networkStatus:E.error},r,e,t,c,p,d.current)},O={current:e.subscribe(h,w)};return function(){setTimeout(function(){return O.current.unsubscribe()})}},[u,i,e,r,c,t]),function(){return f||R(r,e,d.current,c,t)},function(){return f||R(r,e,d.current,c,t)})}function ar(r,e,t){e&&t&&(e.registerSSRObservable(r),r.getCurrentResult().loading&&e.addObservableQueryPromise(r))}function ur(r,e,t,n,a){var u;e[k]&&!Q(e[k],a)&&(e.reobserve(N(e,t,n,a)),r.previousData=((u=r.current)===null||u===void 0?void 0:u.data)||r.previousData,r.current=void 0),e[k]=a}function ir(r,e,t,n){t===void 0&&(t={});var a=t.skip;t.ssr,t.onCompleted,t.onError;var u=t.defaultOptions,c=F(t,["skip","ssr","onCompleted","onError","defaultOptions"]);return function(i){var o=Object.assign(c,{query:e});return n&&(o.fetchPolicy==="network-only"||o.fetchPolicy==="cache-and-network")&&(o.fetchPolicy="cache-first"),o.variables||(o.variables={}),a?(o.initialFetchPolicy=o.initialFetchPolicy||o.fetchPolicy||b(u,r.defaultOptions),o.fetchPolicy="standby"):o.fetchPolicy||(o.fetchPolicy=(i==null?void 0:i.options.initialFetchPolicy)||b(u,r.defaultOptions)),o}}function N(r,e,t,n){var a=[],u=e.defaultOptions.watchQuery;return u&&a.push(u),t.defaultOptions&&a.push(t.defaultOptions),a.push(z(r&&r.options,n)),a.reduce(G)}function P(r,e,t,n,a,u,c){var i=e.current;i&&i.data&&(e.previousData=i.data),!r.error&&j(r.errors)&&(r.error=new A({graphQLErrors:r.errors})),e.current=x(sr(r,t,a),e.previousData,t,n),u(),or(r,i==null?void 0:i.networkStatus,c)}function or(r,e,t){if(!r.loading){var n=cr(r);Promise.resolve().then(function(){n?t.onError(n):r.data&&e!==r.networkStatus&&r.networkStatus===E.ready&&t.onCompleted(r.data)}).catch(function(a){globalThis.__DEV__!==!1&&M.warn(a)})}}function R(r,e,t,n,a){return r.current||P(e.getCurrentResult(),r,e,a,n,function(){},t),r.current}function b(r,e){var t;return(r==null?void 0:r.fetchPolicy)||((t=e==null?void 0:e.watchQuery)===null||t===void 0?void 0:t.fetchPolicy)||"cache-first"}function cr(r){return j(r.errors)?new A({graphQLErrors:r.errors}):r.error}function x(r,e,t,n){var a=r.data;r.partial;var u=F(r,["data","partial"]),c=S(S({data:a},u),{client:n,observable:t,variables:t.variables,called:r!==I&&r!==L,previousData:e});return c}function sr(r,e,t){return r.partial&&t&&!r.loading&&(!r.data||Object.keys(r.data).length===0)&&e.options.fetchPolicy!=="cache-only"?(e.refetch(),S(S({},r),{loading:!0,networkStatus:E.refetch})):r}var I=D({loading:!0,data:void 0,error:void 0,networkStatus:E.loading}),L=D({loading:!1,data:void 0,error:void 0,networkStatus:E.ready});function fr(r){return{refetch:r.refetch.bind(r),reobserve:r.reobserve.bind(r),fetchMore:r.fetchMore.bind(r),updateQuery:r.updateQuery.bind(r),startPolling:r.startPolling.bind(r),stopPolling:r.stopPolling.bind(r),subscribeToMore:r.subscribeToMore.bind(r)}}export{vr as u};
